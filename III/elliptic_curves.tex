\documentclass[a4paper]{article}

\def\npart{III}

\def\ntitle{Elliptic Curves}
\def\nlecturer{T.\ A.\ Fisher}

\def\nterm{Michaelmas}
\def\nyear{2019}

\input{header}

\theoremstyle{definition}
\newtheorem*{fact}{Fact}


\renewcommand*{\P}{\mathbb{P}}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\Div}{Div} % divisor
\DeclareMathOperator{\Pic}{Pic} % Picard group
\newcommand{\rational}{\dashrightarrow} % rational map

\begin{document}


\input{titlepage}

\tableofcontents

\section{Fermat's method of infinite descent}

Let \(\Delta = (a, b, c)\) be a right angle triangle with sides \(a, b, c\) where \(c\) is the hypotenuse.

\begin{definition}
  \(\Delta\) is rational if \(a, b, c \in \Q\). \(\Delta\) is primitive if \(a, b, c \in \Z\) and coprime.
\end{definition}

\begin{lemma}
  Every primitive triangle is of the form \((u^2 - v^2, 2uv, u^2 + v^2)\) for some \(u, v \in \Z, u > v > 0\).
\end{lemma}

\begin{proof}
  \(a\) and \(b\) cannot be both even. They cannot be both odd as then \(c^2 = 2 \mod 4\). Thus wlog \(a\) is odd and \(b\) is even, so \(c\) odd. Then
  \[
    \left(\frac{b}{2}\right)^2 = \frac{c + a}{2} \cdot \frac{c - a}{2}
  \]
  and the two terms on RHS are coprime positive integers. By unique factorisation in \(\Z\), there exist \(u, v \in \Z\) such that
  \begin{align*}
    \frac{c + a}{2} &= u^2 \\
    \frac{c - a}{2} &= v^2
  \end{align*}
  Rearrange.
\end{proof}

\begin{definition}
  \(D \in \Q_{> 0}\) is a \emph{congruent number} if there exists a right angle triangle whose area is \(D\).
\end{definition}

\begin{note}
  Suffices to consider \(D \in \Z_{> 0}\) square-free.
\end{note}

\begin{eg}
  \(D = 5, 6\) are congruent.
\end{eg}

\begin{lemma}
  \(D \in \Q_{> 0}\) is congruent if and only if \(D y^2 = x^3 - x\) for some \(x, y \in \Q, y \neq 0\).
\end{lemma}

\begin{proof}
  Lemma 1 shows that \(D\) is congruent if and only if \(Dw^2 = uv(u^2 - v^2)\) for some \(u, v, w \in \Q, w \neq 0\). Let \(x = \frac{u}{v}, y = \frac{w}{v^2}\).
\end{proof}

Fermat showed that \(1\) is not a congruent number.

\begin{theorem}
  There are no solutions to
  \begin{equation}
    \label{eqn:fermat}
    w^2 = uv (u - v)(u + v)
    \tag{\ast}
  \end{equation}
  for \(u, v, w \in \Z, w \neq 0\).
\end{theorem}

\begin{proof}
  wlog \(u, v \) coprime, \(u > 0, w > 0\). If \(v < 0\) then replace \((u, v, w)\) by \((-v, u, w)\). If \(u = v \mod 2\) then replace \((u, v, w)\) by \((\frac{u + v}{2}, \frac{u - v}{2}, \frac{w}{2})\). Then \(u, v, u - v, u + v\) are positive coprime integers whose product is a square. By unique prime factorisation, \(u = a^2, v = b^2, u + v = c^2, u - v = d^2\) for some \(a, b, c, d \in \Z_{> 0}\). As \(u \neq v \mod 2\), \(c, d\) are both odd. Consider a new triangle with sides \(\frac{c + d}{2}, \frac{c - d}{2}\). Then
  \[
    \left( \frac{c + d}{2} \right)^2 + \left( \frac{c - d}{2} \right)^2 = \frac{c^2 + d^2}{2} = u = a^2
  \]
  so this is another primitive triangle. Its area is
  \[
    \frac{c^2 - d^2}{8} = \frac{v}{4} = \left( \frac{b}{2} \right)^2.
  \]

  Let \(w_1 = \frac{b}{2}\) so by lemma 1
  \[
    w_1^2 = u_1v_1 (u_1 - v_1)(u_1 + v_1),
  \]
  i.e.\ we have a new solution to \eqref{eqn:fermat}. But \(4 w_1^2 = b^2 = v \divides w^2\) so \(w_1 \leq \frac{1}{2} w\). So by Fermat's method of infinite descend, there is no solution to \eqref{eqn:fermat}.
\end{proof}

\subsection{A variant for polynomials}

Let \(K\) be a field with \(\ch K \neq 2\). Let \(\overline K\) be an algebraic closure of \(k\).

\begin{lemma}
  Let \(u, v \in K[t]\) coprime. If \(\alpha u + \beta v\) is a square for four distinct \((\alpha: \beta) \in \P^1\) then \(u, v \in K\).
\end{lemma}

\begin{proof}
  wlog \(K = \overline K\). Changing coordinates on \(\P^1\), we may assume the ratio \((\alpha: \beta)\) are \((1: 0), (0: 1), (1: -1), (1: -\lambda)\) for some \(\lambda \in K \setminus \{0, 1\}\). Thus we have
  \begin{align*}
    u &= a^2 \\
    v &= b^2 \\
    u - v &= (a - b)(a + b) \\
    u - \lambda v &= (a - \mu b)(a + \mu b)
  \end{align*}
  where \(\mu = \sqrt \lambda\). Use unqiue factorisation in \(K[t]\),  as \(a, b\) are coprime, \(a + b, a - b, a - \mu b, a + \mu b\) are squares. But
  \[
    \max (\deg (a), \deg (b)) \leq \frac{1}{2} \max (\deg (u), \deg (v))
  \]
  so by Fermat's method of infinite descend, \(u, v \in K\).
\end{proof}

\begin{definition}[elliptic curve]\index{ellptic curve}\leavevmode
  \begin{enumerate}
  \item An \emph{elliptic curve} \(E/K\) is the projective closure of a plane affine curve \(y^2 = f(x)\) where \(f \in K[x]\) is a monic cubic polynomial with distinct roots in \(\overline K\). The equation \(y^2 = f(x)\) is called a \emph{Weierstrass function}\index{Weierstrass function}.
  \item For \(L/K\) a field extension,
    \[
      E(L) = \{(x, y) \in L^2: y^2 = f(x)\} \cup \{0\}
    \]
    where \(0\) is the point at infinity in the projective closure.
  \end{enumerate}
\end{definition}

Fact: \(E(L)\) is naturally an abelian group.

In this course we study \(E(L)\) for \(L\) finite field, local field (meaning \(L/\Q_p\) finite in this course) or number field (\(L/\Q\) finite).

\begin{theorem}
  If \(E: y^2 = x^3 - x\) then \(E(\Q) = \{0, (0, 0), (\pm 1, 0)\}\).
\end{theorem}

\begin{corollary}
  Let \(E/K\) be an elliptic curve. Then \(E(K(t)) = E(K)\).
\end{corollary}

\begin{proof}
  wlog \(K = \overline K\). By a change of coordinates we may assume
  \[
    E: y^2 = x(x - 1)(x - \lambda)
  \]
  for some \(\lambda \in K \setminus \{0, 1\}\). Suppose \((x, y) \in E(K(t))\). Write \(x = \frac{u}{v}\) where \(u, v \in K[t]\) coprime. Then
  \[
    w^2 = uv(u - v)(u - \lambda v)
  \]
  for some \(w \in K[t]\). Using same unique factorisation argument as before, \(u, v, u - v, u - \lambda v\) are all squares so by lemma \(u, v \in K\) so \(x, y \in K\).
\end{proof}

\section{Some remarks on algebraic curves}

Let \(K = \overline K, \ch K \neq 2\).

\begin{definition}[rational plane curve]\index{rational plane curve}
  A plane algebraic curve (always assumed to be irreducible)
  \[
    C = \{f(x, y) = 0\} \subseteq \A^2
  \]
  is \emph{rational} if it has a rational parameterisation, i.e.\ there exist \(\phi, \psi \in K(t)\) such that
  \begin{enumerate}
  \item \(\A^1 \to \A^2, t \mapsto (\phi(t), \psi(t))\) is injective on \(\A^1 \setminus \{\text{finite set}\}\).
  \item \(f(\phi(t), \psi(t)) = 0\).
  \end{enumerate}
\end{definition}

\begin{eg}\leavevmode
  \begin{enumerate}
  \item Any nonsingular plane conic is rational. For example \(x^2 + y^2 = 1\). Pick a point \((-1, 0)\). Putting a line through the point with slope \(t\), i.e.\ \(y = t(x + 1)\). Solve for the intersection. In general we will get a root, which is not rational. But in the quadratic case we already have one solution so the other solution can be expressed as a rational function. we have
    \[
      x^2 + t^2(x + 1)^2 = 1
    \]
    which is saying
    \[
      (x + 1)(x - 1 + t^2(x + 1)) = 0
    \]
    so \(x = -1\) or \(x = \frac{1 - t^2}{1 + t^2}\). Similarly one can solve \(y\). Then we get rational parameterisation
    \[
      (x, y) = \left( \frac{1 - t^2}{1 + t^2}, \frac{2t}{1 + t^2} \right).
    \]
  \item Any singular plane curve is rational. Two examples: \(y^2 = x^3, y^2 = x^2 (x + 1)\). Same recipe as before except that we have to pick the singular point, which is the origin in both cases. The line \(y = tx\) intersects the curve. We get rational parameterisation \((x, y) = (t^2, t^3)\) for the first one. The second is an exercise.
  \item Corollary 1.6 shows that elliptic curves are \emph{not} rational.
  \end{enumerate}
\end{eg}

\begin{remark}
  The genus \(g(C) \in \Z_{\geq 0}\) is an invariant of a smooth projective curve \(C\). Some facts:
  \begin{enumerate}
  \item if \(k = \C\) then \(g(C)\) is the genus of the Riemann surface.
  \item a smooth plane curve \(C \subseteq \P^2\) of degree \(d\) has genus \(g(C) = \frac{(d - 1)(d - 2)}{2}\).
  \end{enumerate}
\end{remark}

\begin{proposition}
  Let \(C\) be a smooth projective curve.
  \begin{enumerate}
  \item \(C\) is rational if and only if \(g(C) = 0\).
  \item \(C\) is an elliptic curve if and only if \(g(C) = 1\).
  \end{enumerate}
\end{proposition}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item Omitted.
  \item For only if, check the projective closure is smooth and use remark. For if, see later.
  \end{enumerate}
\end{proof}

\subsection{Order of vanishing}

Let \(C\) be an algebraic curve with function field \(K(C)\). Let \(P \in C\) be a smooth point. We write \(\ord_P(f)\) to be the order of vanishing to be the order of vanishing of \(f \in K(C)\) at \(P\). It is negative if \(f\) has a pole at \(P\).

Some facts: \(\ord_P(f): K(C)^* \to \Z\) is a discrete valuation, i.e.
\begin{align*}
  \ord_P(f_1f_2) &= \ord_P(f_1) + \ord_P(f_2) \\
  \ord_P(f_1 + f_2) & \geq \min(\ord_P(f_1), \ord_P(f_2))
\end{align*}

\begin{definition}[uniformiser]\index{uniformiser}
  \(t \in K(C)^*\) is a \emph{uniformiser} at \(P\) if \(\ord_P(t) = 1\).
\end{definition}

\begin{eg}
  Let \(C = \{g = 0\} \subseteq \A^2\) for some \(g \in K[x, y]\) irreducible. Then
  \[
    K(C) = \operatorname{Frac} \frac{K[x, y]}{(g)}.
  \]
  Write
  \[
    g = g_0 + g_1(x, y) + g_2(x, y) + \dots
  \]
  where \(g_i\) is homogeneous of degree \(i\). Suppose \(P = (0, 0) \in C\) is smooth, i.e.\ \(g_0 = 0, g_1(x, y) = \alpha x + \beta y\) where \(\alpha, \beta\) not both zero. (Picture). Let \(\gamma, \delta \in K\). It is a fact that \(\gamma x + \delta y \in K(C)\) is a uniformiser at \(P\) if and only if \(\alpha \delta - \beta \gamma \neq 0\).
\end{eg}

\begin{eg}
  Consider \(\{y^2 = x(x - 1)(x - \lambda)\} \subseteq \A^2\) where \(\lambda \neq 0, 1\). Its projective closure is \(\{Y^2Z = X(X - Z)(X - \lambda Z)\} \subseteq \P^2\), then we get one point \(P = (0: 1: 0)\) at infinity. We can compute \(\ord_P(x)\) and \(\ord_P(y)\). We work on the affine piece \(\{Y \neq 0\}\). Put \(w = \frac{Z}{Y}, t = \frac{X}{Y}\), then the equation becomes
  \[
    w = t(t - w)(t - \lambda w).
  \]
  Now \(P\) is the point \((t, w) = (0, 0)\). This is a smooth point and using the fact in the above example,
  \[
    \ord_P(t) = \ord_P(t - w) = \ord_P(t - \lambda w) = 1,
  \]
  so \(\ord_P(w) = 3\). Finally,
  \begin{align*}
    \ord_P(x) &= \ord_P \frac{X}{Z} = \ord_P \frac{t}{w} = -2 \\
    \ord_P(y) &= \ord_P \frac{Y}{Z} = \ord_P \frac{1}{w} = -3
  \end{align*}
\end{eg}

Let \(C\) be a smooth projective curve.

\begin{definition}[divisor]\index{divisor}
  A \emph{divisor} is a formal sum of points on \(C\), say \(D = \sum_{P \in C} n_P P\) with \(n_P \in \Z\) and \(n_P = 0\) for all but finitely many \(P\). The \emph{degree} of \(D\) is
  \[
    \deg D = \sum n_P.
  \]
\end{definition}

\begin{definition}[effective divisor]\index{divisor!effective}
  A divisor \(D\) is \emph{effective}, written \(D \geq 0\), if \(n_P \geq 0\) for all \(P\).
\end{definition}

If \(f \in K(C)^*\) then we write
\[
  \div(f) = \sum_{P \in C} \ord_P(f) P.
\]

The \emph{Riemann-Roch space} of \(D \in \Div(C)\) is
\[
  \mathcal L(D) = \{f \in K(C)^*: \div(f) + D \geq 0\} \cup \{0\},
\]
i.e.\ the \(K\)-vector space of rational functions on \(C\) with ``pole no worse than specified by \(D\)''.

Riemann-Roch for genus \(1\) curve says that
\[
  \dim \mathcal L(D) =
  \begin{cases}
    \deg D & \deg D > 0 \\
    0 \text{ or } 1 & \deg D = 0 \\
    0 & \deg D < 0 
  \end{cases}
\]

\begin{eg}
  Let us revisit some of the previous example. Consider \(\{y^2 = x(x - 1)(x - \lambda)\} \subseteq \A^2\) and let \(P\) the point at infinity. We calculated \(\ord_P(x) = -2, \ord_P(y) = -3\). Then
  \begin{align*}
    \mathcal L(2P) &= \langle 1, x \rangle \\
    \mathcal L(3P) &= \langle 1, x, y \rangle
  \end{align*}
\end{eg}

\begin{proposition}
  Let \(C \subseteq \P^2\) be a smooth plane cubic and \(P \in C\) a point of inflection. Then we can change coordinates such that \(C: Y^2Z = X(X - Z)(X - \lambda Z)\) and \(P = (0: 1: 0)\).
\end{proposition}

\begin{fact}
  The points of inflection on \(C = \{F = 0\} \subseteq \P^2\) are given by
  \[
    F = \det \frac{\p^2 F}{\p x_i \p x_j} = 0.
  \]
\end{fact}

\begin{proof}
  We change coordinates such that \(P = (0 : 1 : 0)\) and \(T_pC = \{Z = 0\}\), where \(C = \{F(X, Y, Z) = 0\}\). \(P \in C\) is a point of inflection, meaning that the intersection of the tangent at \(P\) with \(C\) has multiplicity \(3\), so \(F(t, 1, 0)\) is a constant multiple of \(t^3\). Thus there is no \(X^2Y, XY^2\) and \(Y^3\) term, so
  \[
    F \in \langle Y^2Z, XYZ, YZ^2, X^3, X^2Z, XZ^2, Z^3 \rangle.
  \]
  The coefficient of \(X^3\) is nonzero as otherwise \(\{Z = 0\} \subseteq C\). The coefficient of \(Y^2Z\) is nonzero as otherwise \(P \in C\) is singular. We are free to rescale \(X, Y, Z\) and \(F\), so wlog \(C\) is defined by
  \[
    Y^2Z + a_1 XYZ + a_3 YZ^2 = X^3 + a_2 X^2Z + a_4 XZ^2 + a_6 Z^3.
  \]
  Making substitutions \(Y \mapsto Y - \frac{1}{2} a_1X - \frac{1}{2} a_3 X\), w may asssume \(a_1 = a_3 = 0\). Now \(C: Y^2Z = Z^3 f(X/Z)\) where \(f\) is a monic cubic polynomial. As \(C\) is smooth, \(f\) has distinct roots so wlog \(0, 1, \lambda\) so \(C\) is
  \[
    Y^2Z = X(X - Z)(X - \lambda Z).
  \]
\end{proof}

The equation
\[
  Y^2Z + a_1 XYZ + a_3 YZ^2 = X^3 + a_2 X^2Z + a_4 XZ^2 + a_6 Z^3
\]
is called \emph{Weierstrass form} and
\[
  Y^2Z = X(X - Z)(X - \lambda Z)
\]
is called \emph{Legendre form}.

\subsection{Degree of a morphism}

Let \(\phi: C_1 \to C_2\) be a nonconstant morphism of smooth projective curves. Let \(\phi^*: K(C_2) \to K(C_1)\) be the pullback by \(\phi\).

\begin{definition}[degree of morphism]
  The \emph{degree} of \(\phi\) is
  \[
    \deg \phi = [K(C_1): \phi^*K(C_2)],
  \]
  the degree of the field extension. \(\phi\) is \emph{separable} if the corresponding field extension is separable (which is automatic if \(\ch K = 0\)).
\end{definition}

\begin{fact}
  \(\deg \phi = 1\) if and only if \(\phi\) is an isomorphism.
\end{fact}

\begin{definition}[ramification index]\index{ramification index}
  Suppose \(P \in C_1, Q \in C_2\) are such that \(\phi(P) = Q\). Let \(t \in K(C_2)\) be an uniformiser at \(Q\). The \emph{ramification index} of \(\phi\) at \(P\) is
  \[
    e_\phi(P) = \ord_P(\phi^*t).
  \]
\end{definition}

It is independent of the choice of uniformiser and is always greater than \(0\).
 
\begin{theorem}
  Let \(\phi: C_1 \to C_2\) be a nonconstant morphism of smooth projective curves. Then
  \[
    \sum_{P \in \phi^{-1}(Q)} e_\phi(P) = \deg \phi
  \]
  for all \(Q \in C_2\).

  Moreover, if \(\phi\) is separable then \(e_\phi(P) = 1\) for all but finitely many \(P \in C_1\).
\end{theorem}

In particular,
\begin{enumerate}
\item \(\phi\) is surjective (note that we are working over algebraically closed fields).
\item \(\# \phi^{-1}(Q) \leq \deg \phi\) with equality for all but finitely many \(Q \in C_2\).
\end{enumerate}

\begin{remark}
  Let \(C\) be an algebraic curve. A rational map is given by
  \begin{align*}
    \phi: C &\rational \P^n \\
    P &\mapsto (f_0(P) : f_1(P) : \cdots : f_n(P))
  \end{align*}
  where \(f_0, \dots, f_n \in K(C)\) not all zero.
\end{remark}

\begin{fact}
  If \(C\) is smooth then \(\phi: C \rational \P^n\) is a morphism.
\end{fact}

\section{Weierstrass equations}

We assume \(K\) is a perfect field with algebraic closure \(\overline K\) in this chapter.

\begin{definition}[elliptic curve]\index{elliptic curve}
  An \emph{elliptic curve} \(E\) over \(K\) is a smooth projective curve of genus \(1\) defined over \(K\) with a specified \(K\)-rational point \(0_E\).
\end{definition}

\begin{eg}
  \(\{X^3 + pY^3 + p^2Z^3 = 0\} \subseteq \P^2\) is smooth but is \emph{not} an elliptic curve over \(\Q\) since it has no \(\Q\)-rational pionts.
\end{eg}

\begin{theorem}
  Every elliptic curve \(E\) is isomorphic over \(K\) to a curve in Weierstrass form via an isomorphism taking \(0_E\) to \((0 : 1 : 0)\).
\end{theorem}

\begin{remark}
  Proposition 2.7 treated the special case \(E\) is a smooth plane cubic and \(0_E\) is a point of inflection.
\end{remark}

\begin{fact}
  If \(D \in \Div(E)\) is defined over \(K\) (i.e. it is fixed by \(\operatorname{Gal}(\overline K/K)\)) then \(\mathcal L(D)\) has a basis in \(K(E)\) (not just \(\overline K(E)\).
\end{fact}

\begin{proof}
  We have \(\mathcal L(2 \cdot 0_E) \subseteq \mathcal L(3 \cdot 0_E)\) with dimension \(2\) and \(3\) respectively. Pick basis \(1, x\) for \(\mathcal L(2 \cdot 0_E)\) and \(1, x, y \in \mathcal L(3 \cdot 0_E)\). Note that this implies \(\ord_{0_E}(x) = 2, \ord_{0_E}(y) = 3\). The seven elements \(1, x, y, x^2, xy, x^3, y^2\) in the \(6\)-dim vector space \(\mathcal L(6 \cdot 0_E)\) must satisfy a dependence relation. Leaving out \(x^3\) or \(y^2\) gives a basis for \(\mathcal L(6 \cdot 0_E)\) since each term has a different order of pole at \(0_E\), so coefficients of \(x^3\) and \(y^2\) are nonzero. Rescaling \(x\) and \(y\), we get
  \[
    y^2 + a_1 xy + a_3 y = x^3 + a_2 x^2 + a_4 x + a_6.
  \]
  By the fact above, we can take \(a_i \in K\).

  Let \(E'\) be the projective closure of the curve defined by Weierstrass form. There is a morphism
  \begin{align*}
    \phi: E &\to E' \\
    p &\mapsto (x(P) : y(P) : 1)
  \end{align*}
  Left to show \(\phi\) is an isomorphism, i.e.\ \(\deg \phi = 1\). We have
  \begin{align*}
    [K(E) : K(x)] &= \deg (x: E \to \P^1) = \ord_{0_E}(\frac{1}{x}) = 2 \\
    [K(E) : K(y)] &= \deg (y: E \to \P^1) = \ord_{0_E}(\frac{1}{y}) = 3
  \end{align*}
  So by tower law
  \[
    [K(E): K(x, y)] = 1.
  \]
  As \(K(x, y) = \phi^* K(E')\) so \(\deg \phi = 1\) so \(\sigma\) is birational. If \(E'\) is singular then (? genus 0) \(E\) and \(E'\) are both rational. So \(E'\) is nonsingular and \(\phi^{-1}\) is a morphism.

  To find the image of \(0_E\), we cannot simply plug \(0_E\) in as \(x, y\) both have poles at infinity. Instead, we multiply through to get
  \begin{align*}
    \phi: E &\to E' \\
    P &\mapsto (\frac{x}{y} (P) : 1 : \frac{1}{y} (P))
  \end{align*}
  so \(\phi(0_E) = (0 : 1 : 0)\).
\end{proof}

\begin{proposition}
  Let \(E\) and \(E'\) be elliptic curves over \(K\) in Weierstrass form. Then \(E \cong E'\) over \(K\) if and only if the equations are related by a change of variables
  \begin{align*}
    x &= u^2 x' + r \\
    y &= u^3 y' + u^2 s x' + t
  \end{align*}
  where \(u, r, s, t \in K, u \neq 0\).
\end{proposition}

\begin{proof}
  We check the process of putting a single elliptic curve in Weierstrass form and see what choices we can make. Suppose
  \begin{align*}
    \langle 1, x \rangle &= \mathcal L(2 \cdot 0_E) = \langle 1, x' \rangle \\
    \langle 1, x, y \rangle &= \mathcal L(3 \cdot 0_E) = \langle 1, x', y' \rangle
  \end{align*}
  so
  \begin{align*}
    x &= \lambda x' + r \\
    y &= \mu y' + \sigma x' + t
  \end{align*}
  where \(\lambda, r, \mu, \sigma, t \in K, \lambda, \mu \neq 0\). Looking at coefficients of \(x^3\) and \(y^2\), must have \(\lambda^3 = \mu^2\) so \((\lambda, \mu) = (u^2, u^3)\) for some \(u \in K^*\). Finally put \(s = \sigma/u^2\).
\end{proof}

A Weierstrass equation defines an elliptic curve if and only if it defines a smooth curve, if and only if \(\Delta(a_1, \dots a_6) \neq 0\) where \(\Delta \in \Z[a_1, \dots, a_6]\) is a certain polynomial. Details can be found out in the lecture handout.

If \(\ch K \neq 2, 3\) then we can reduce the curve to \(E: y^2 = x^3 + ax + b\) with discriminant \(\Delta = -16(4a^3 + 27b^2)\).

\begin{corollary}
  Assume \(\ch k \neq 2, 3\). Elliptic curves
  \begin{align*}
    E: y^2 &= x^3 + ax + b \\
    E': y^2 &= x^3 + a'x + b'
  \end{align*}
  are isomorphic over \(K\) if and only if
  \begin{align*}
    a' &= u^4a \\
    b' &= u^6b
  \end{align*}
  for some \(u \in K^*\).
\end{corollary}

\begin{proof}
  \(E\) and \(E'\) are related as in proposition 3.2 with \(r = s = t = 0\).
\end{proof}

\begin{definition}[\(j\)-invariant]\index{\(j\)-invariant}
  The \emph{\(j\)-invariant} of an elliptic curve \(E\) is
  \[
    j(E) = \frac{1728 (4a^3)}{4a^3 + 27b^2}.
  \]
\end{definition}

This is just the ratio \((a^3 : b^2)\) up to a MÃ¶bius transform.

\begin{corollary}
  If \(E \cong E'\) then \(j(E) = j(E')\) and the converse holds if \(K = \overline K\).
\end{corollary}

\begin{proof}
  \(E \cong E'\) if and only if \(a' = u^4 a, b' = u^6 b\) for some \(u \in K^*\), which implies that \((a^3: b^2) = ((a')^3 : (b')^2)\), which holds if and only if \(j(E) = j(E')\). If \(K = \overline K\) then we can extract roots and the converse of the second implication holds.
\end{proof}

\section{The group law}

Let \(E \subseteq \P^2\) be a smooth plane cubic and \(0_E \in E(K)\). \(E\) meets each line in 3 points, counted with multiplicity. Given \(P, Q \in E\), let \(S\) be the third point of intersection of \(PQ\) and \(E\). Let \(R\) be the third point of intersection of \(0_ES\) and \(E\). We define
\[
  P \oplus Q = R.
\]
If \(P = Q\) then take the tangent at \(P\) instead of \(PQ\). This is the ``chord and tangent process''.

\begin{theorem}
  \((E, \oplus)\) is an abelian group.
\end{theorem}

Here we recall a convention: if we don't specify the field extension the we mean the algebraic claosure. In notation: \(E = E(\overline K)\).

\begin{proof}\leavevmode
  \begin{enumerate}
  \item \(P \oplus Q = Q \oplus P\).
  \item \(0_E\) is the identity.
  \item For inverse, let \(S\) be the point of intersection of \(T_{0_E}E\) and \(E\), \(Q\) the third point of intersection of \(PS\) and \(E\). Then \(P \oplus Q = 0_E\).
  \item Associativity is much harder, and we'll prove it using divisors.
  \end{enumerate}
\end{proof}

\begin{definition}[linearly equivalent divisor]\index{divisor!lienarly equivalent}
  \(D_1, D_2 \in \Div(E)\) are \emph{linearly equivalent}, written \(D_1 \sim D_2\), if exists \(f \in \overline K(E)^*\) such that \(\div (f) = D_1 - D_2\).
\end{definition}

This is an equivalence relation and we define

\begin{definition}[Picard group]\index{Picard group}
  The \emph{Picard group} is defined to be
  \[
    \Pic(E) = \Div (E)/\sim.
  \]
\end{definition}

\begin{definition}
  We let
  \[
    \Div^0(E) = \ker (\deg: \Div(E) \to \Z)
  \]
  and
  \[
    \Pic^0(E) = \Div^0(E)/\sim.
  \]
\end{definition}

\begin{proposition}
  Let
  \begin{align*}
    \phi: E &\to \Pic^0(E) \\
    P &\mapsto [P - 0_E]
  \end{align*}
  then
  \begin{enumerate}
  \item \(\phi(P \oplus Q) = \phi(P) + \phi(Q)\).
  \item \(\phi\) is a bijection.
  \end{enumerate}
\end{proposition}

\begin{proof}\leavevmode
  \begin{enumerate}
  \item Let \(\ell\) be the line \(PQ\) and \(m\) the curve \(0_ES\). Then
    \[
      \div (\frac{\ell}{m})
      = (P) + (S) + (Q) - (R) - (S) - (0_E)
      = (P) + (Q) - (P \oplus Q) - (0_E)
    \]
    so \((P) + (Q) \sim (P \oplus Q) + (0_E)\) and so
    \[
      (P) - (0_E) + (Q) - (0_E) = (P \oplus Q) - (0_E)
    \]
    so \(\phi(P \oplus Q) = \phi(P) + \phi(Q)\).
  \item For injectivity, suppose \(\phi(P) = \phi(Q)\) for \(P \neq Q\). Then exists \(f \in \overline K(E)^*\) such that \(\div (f) = P - Q\). Then
    \[
      \deg (f: E \to \P^1) = \ord_P(f) = 1
    \]
    so \(E \cong \P^1\), absurd.

    For surjectivity, let \([D] \in \Pic^0(E)\). Then \(D + (0_E)\) has degree \(1\). Riemann-Roch tells us that \(\mathcal L(D + (0_E)) = 1\) so exists \(f \in \overline K(E)^*\) such that
    \[
      \div(f) + D + (0_E) \geq 0
    \]
    and furthermore LHS has degree \(1\). Thus it has to be \((P)\) for some \(P \in E\). It follows that \((P) - (0_E) \sim D\).
  \end{enumerate}
\end{proof}

In a nutshell, \(\phi\) identifies \((E, \oplus)\) with \((\Pic^0(E), +)\) so \(\oplus\) is associative.

\subsection{Explicit formula for the group law}

We consider \(E\) in Weierstrass form and \(0_E\) the point at infinity.
\[
  y^2 + a_1xy + a_3 y = x^3 + a_2x^2 + a_4x + a_6
\]

\begin{remark}
  \(0_E\) is a point of inflection so now we can characterise the group law as \(P_1 \oplus P_2 \oplus P_3 = 0_E\) if and only if \(P_1, P_2, P_3\) are colinear.
\end{remark}

The inverse of \(P = (x_1, y_1)\) is the intersection of \(P0_E\), which is the vertical line, and \(E\) so is given by
\[
  \ominus P = (x_1, -(a_1x_1 + a_3) - y_1).
\]
Given \(P_1 = (x_1, y_1), P_2 = (x_2, y_2)\), want to find an expression for \(P_3 = P_1 \oplus P_2\). Let \(P_1P_2\) intersect \(E\) at \(P' = (x', y')\). Then \(P_3 = P_1 \oplus P_2 = \ominus P'\). Substitute \(y = \lambda x + \nu\) into * and looking at the coefficient of \(x^2\) gives
\[
  \lambda^2 + a_1 \lambda - a_2 = x_1 + x_2 + x'
\]
which gives
\begin{align*}
  x_3 &= \lambda^2 + a_1 \lambda - a_2 - x_1 - x_2 \\
  y_3 &= -(a_1x' + a_3) - (\lambda x' + \nu) = -(\lambda + a_1) x_3 - \nu - a_3
\end{align*}
It remains to find formula for \(\lambda\) and \(\nu\). If \(x_1 = x_2\) and \(P_1 \neq P_2\) then \(P_1 \oplus P_2 = 0_E\). For the general case \(x_1 \neq x_2\), have
\begin{align*}
  \lambda &= \frac{y_2 - y_1}{x_2 - x_1} \\
  \nu &= y_1 - \lambda x_1 = \frac{x_2y_1 - x_1 y_2}{x_2 - x_1}
\end{align*}
Finally the case \(P_1 = P_2\) is left as an exercise.

\begin{corollary}
  \(E(K)\) is an abelian group.
\end{corollary}

\begin{proof}
  It is a subgroup of \(E\):
  \begin{itemize}
  \item identity: \(0_E \in E(K)\) by definition,
  \item closure/inverses: see formula above.
  \item associativity/commutativity: inherited.
  \end{itemize}
\end{proof}

\begin{theorem}
  Elliptic curves are group varieties, i.e.\ \([-1]: E \to E, +: E \times E \to E\) are morphisms of algebraic varieties.
\end{theorem}

\begin{proof}
  The above formulae show \([-1]\) and \(+\) are rational maps. \([-1]: E \to E\) is a map from a smooth curve to a projective variety so is a morphism. Unfortunately there is no such result for surfaces. Instead, the formulae also show \(+\) is regular on
  \[
    U = \{(P, Q) \in E \times E: P, Q, P + Q, P - Q \neq 0_E\}.
  \]
  For \(P \in E\), let \(\tau_P: E \to E, X \mapsto P + X\) be translation by \(P\). \(\tau_P\) is a rational map so a morphism. We factor \(+\) as
  \[
    \begin{tikzcd}
      E \times E \ar[r, "\tau_{-A} \times \tau_{-B}"] & E \times E \ar[r, "+"] & E \ar[r, "\tau_{A + B}"] & E
    \end{tikzcd}
  \]
  so \(+\) is regular on \((\tau_A, \tau_B)(U)\) for all \(A, B \in E\) so \(+\) is regular on \(E \times E\).
\end{proof}

\begin{definition}[torsion subgroup]\index{torsion subgroup}
  For \(n \in \Z\), let \([n]: E \to E\) be the ``\(n\) times'' map. The \emph{\(n\)-torsion subgroup} of \(E\) is \(E[n] = \ker([n]: E \to E)\).
\end{definition}

\begin{lemma}
  Assume \(\ch k \neq 2\) and \(E: y^2 = f(x) = (x - e_1)(x - e_2)(x - e_3)\) where \(e_i \in \overline K\) distinct. Then
  \[
    E[2] = \{0_E, (e_1, 0), (e_2, 0), (e_3, 0)\} \cong (\Z/2\Z)^2.
  \]
\end{lemma}

\begin{proof}
  Let \(P = (x, y) \in E\). Then \([2] P = 0\) if and only if \(P = - P\) so \((x, y) = (x, -y)\) so \(y = 0\).
\end{proof}

\paragraph{Elliptic curves over \(C\)}

Let \(\Lambda = \{a \omega_1 + b \omega_2: a, b \in \Z\}\) be a lattice, where \(\omega_1, \omega_2\) is a basis for \(\C\) as an \(\R\)-vector space. The the set of meromorphic functions on the Riemann surface \(\C/\Lambda\) is the same as \(\Lambda\)-invariant meromorphisc functions on \(\C\). This field is generated by \(\wp(z)\) and \(\wp'(z)\) where
\[
  \wp(z) = \frac{1}{z^2} + \sum_{\lambda \in \Lambda \setminus \{0\}} \left(\frac{1}{(z - \lambda)^2} - \frac{1}{\lambda^2}\right)
\]
They satisfy
\[
  \wp'(z)^2 = 4 \wp(z)^3 - g_2 \wp(z) - g_3
\]
for some \(g_2, g_3 \in \Lambda\) depending on \(\Lambda\). One shows \(\C/\Lambda \cong E(\C)\) where \(E\) is the elliptic curve
\[
  y_2 = 4x^3 - g_2x - g_3.
\]
The isomorphism is understood as isomorphism of Riemann surfaces and isomorphism of groups.

\begin{theorem}
  Every elliptic curve over \(\C\) arises this way.
\end{theorem}

For elliptic curve \(E/\C\) we have
\begin{enumerate}
\item \(E[n] \cong (\Z/n\Z)^2\).
\item \(\deg [n] = n^2\).
\end{enumerate}
We'll show 2 holds for any field \(K\), and 1 holds if \(\ch k \ndivides n\).

Statement of results
\begin{enumerate}
\item If \(K = \C\) then \(E(\C) \cong \C/\Lambda \cong \R/\Z \cong \R/\Z\).
\item If \(K = \R\) then \(E(\R) \cong
  \begin{cases}
    \Z/2\Z \times \R/\Z & \Delta > 0 \\
    \R/\Z & \Delta < 0
  \end{cases}
  \)
\item If \(K = \F_q\) then \(|E(\F_q) - (q + 1)| \leq 2 \sqrt q\). This is Hasse's theorem.
\item If \([K: \Q_p] < \infty\) with rings of integers \(\mathcal O_K\) then \(E(K)\) has a subgroup of finite index isomorphic to \((\mathcal O_K, +)\).
\item If \([K: \Q] < \infty\) then \(E(K)\) is a finitely generated abelian group. This is Mordell-Weil theorem.
\end{enumerate}

\begin{remark}
  The isomorphisms in 1, 2 and 4 resepcted the relevant topologies.
\end{remark}

\section{Isogenies}

Let \(K\) be any perfect field in this chapter.

Let \(E_1, E_2\) be elliptic curves.

\begin{definition}[isogeny]\index{isogeny}
  An \emph{isogeny} \(\phi: E_1 \to E_2\) is a nonconstant morphism with \(\phi(0_{E_1}) = 0_{E_2}\). We say \(E_1\) and \(E_2\) are \emph{isogenous} if there exists an isogeny from \(E_1\) to \(E_2\).

  We define \(\Hom(E_1, E_2)\) to the be set of all isogenies \(E_1 \to E_2\) plus \(0\). This is a group under
  \[
    (\phi + \psi)(P) = \phi(P) + \psi(P).
  \]
\end{definition}
Note that nonconstant implies that surjectivity on \(\overline K\)-points. The composition of isogenies is an isogeny.

\begin{lemma}
  If \(0 \neq n \in \Z\) then \([n]: E \to E\) is an isogeny.
\end{lemma}

\begin{proof}
  We have checked that \([n]\) is a morphism. We must show \([n] \neq 0\). There is a trick that we can use, if we assume \(\ch K \neq 2\). If \(n = 2\) then we computed last time that \(\E[2]\) has 4 points so \([2] \neq 0\). If \(n\) is odd then let \(T \in E[2]\) be nonzero then \(nT = T \neq 0\) so again \([n] \neq 0\). Now use \([mn] = [m] \compose [n]\).

  If \(\ch K = 2\), we can compute \(E[3]\) as in the lemma before.
\end{proof}

\begin{corollary}
  \(\Hom(E_1, E_2)\) is torsion-free as a \(\Z\)-module.
\end{corollary}

\begin{lemma}
  Let \(\phi: E_1 \to E_2\) be an isogeny. Then \(\phi(P + Q) = \phi(P) + \phi(Q)\) for all \(P, Q \in E\).
\end{lemma}

\begin{proof}[Sketch proof]
  \(\phi\) induces a map
  \begin{align*}
    \phi_*: \Div^0(E_1) &\to \Div^0(E_2) \\
    \sum n_P P &\mapsto \sum n_P \phi(P)
  \end{align*}
  Recall we have a field extension \(\phi^*: K(E_2) \to K(E_1)\) so there is a norm map \(N_{K(E_1)/K(E_2)}: K(E_1) \to K(E_2)\). It is a fact that if \(f \in K(E_1)^*\) then
  \[
    \div (N_{K(E_1)/K(E_2)} f) = \phi_*(\div f)
  \]
  so \(\phi_*\) takes principal divisors to principal divisors. Since \(\phi(0_{E_1}) = 0_{E_2}\), we have a commutative diagram
  \[
    \begin{tikzcd}
      E_1 \ar[r, "\phi"] \ar[d, "\cong"] & E_2 \ar[d, "\cong"] \\
      \Pic^0(E_1) \ar[r, "\phi_*"] & \Pic^0(E_2)
    \end{tikzcd}
  \]
  As \(\phi_*\) is a group homomorphism, so is \(\phi\).
\end{proof}

\begin{eg}
  Let \(E/K\) be an elliptic curve. Suppose \(\ch K \neq 2\) and exists \(0 \neq T \in E(K)[2]\). wlog assume \(E: y^2 = x(x^2 + ax + b)\) with \(a, b \in K, b(a^2 - 4b) \neq 0\) so \(T = (0, 0)\). If \(P = (x, y)\) and \(P' = P + T = (x', y')\) then
  \begin{align*}
    x' &= \left( \frac{y}{x} \right)^2 - a - x = \frac{b}{x} \\
    y' &= - \left( \frac{y}{x} \right) x' = \frac{-by}{x^2}
  \end{align*}
  We define two variables that remain unchanged under (?) swapping
  \begin{align*}
    \xi &= x + x' + a = \left( \frac{y}{x} \right)^2 \\
    \eta &= y + y' = \frac{y}{x} (x - \frac{b}{x})
  \end{align*}
  Then
  \begin{align*}
    \eta^2 &= \left( \frac{y}{x} \right)^2 ((x + \frac{b}{x})^2 - 4b) \\
           &= \zeta ((\zeta - a)^2 - 4b) \\
           &= \zeta (\zeta^2 - 2a\zeta + a^2 - 4b)
  \end{align*}
  Let \(E': y^2 = (x^2 + a'x + b')\) where \(a' = -2a, b' = a^2 - 4b\). Then there is an isogeny
  \begin{align*}
    \phi: E &\to E' \subseteq \P^2 \\
    (x, y) &\mapsto (\xi : \eta : 1)
  \end{align*}
  Left to show \(\phi(0_E) = 0_{E'}\). The three coordinates has a pole of order \(-2, -3, 0\) respectively at \(0_E\) so multiply by uniformiser to the power of three we get \((0:1:0)\).
\end{eg}

\begin{lemma}
  Let \(\phi: E_1 \to E_2\) be an isogeny. Then exists morphism \(\xi\) making the following diagram commute
  \[
    \begin{tikzcd}
      E_1 \ar[r, "\phi"] \ar[d, "x_1"] & E_2 \ar[d, "x_2"] \\
      \P^1 \ar[r, "\xi"] & \P^1
    \end{tikzcd}
  \]
  where \(x_i\) is the \(x\) coordinate on a Weierstrass equation for \(E_i\). Moreover if \(\xi(t) = \frac{r(t)}{s(t)}\) where \(r, s \in K[t]\) coprime then
  \[
    \deg \phi = \deg \xi = \max (\deg (r), \deg (s)).
  \]
\end{lemma}

\begin{eg}
  In the example above we just have \(\xi = \frac{x^2 + ax + b}{x}\) so in particular it has degree \(2\).
\end{eg}

\begin{proof}
  For \(i = 1, 2\), \(K(E_i)/K(x_i)\) is a degree \(2\) Galois extension with Galois group generated by \([-1]^*\).

  \[
    \begin{tikzcd}
      & K(E_1) \ar[dd] \\
      K(x_1) \ar[ur] \ar[dd, dashed] \\
      & K(E_2) \\
      K(x_2) \ar[ur]
    \end{tikzcd}
  \]
  If \(f \in K(x_2)\) then \([-1]^* f = f\) so
  \[
    [-1]^*(\phi^* f) = \phi^*([-1]^* f) = \phi^* f
  \]
  so indeed \(\phi^*f \in K(x_1)\). Taking \(f = x_2\) gives \(\phi^*x_2 = \xi(x_1)\) for some rational function \(\xi\). By tower law \(\deg \phi = \deg \xi\). Now \(K(x_2) \embed K(x_1), x_2 \mapsto \xi(x_1) = \frac{r(x_1)}{s(x_1)}\) for some \(r, s \in K[t]\) coprime. Claim the minimal polynomial of \(x_1\) over \(K(x_2)\) is
  \[
    f(t) = r(t) - s(t)x_2 \in K(x_2)[t].
  \]
  Check \(f(x_1) = 0\). \(f\) is irreducible in \(k[x_2, t]\) (since \(r, s\) are corpime) so by Gauss' lemma \(f\) is irreducible in \(K(x_2)[t]\). Therefore
  \[
    \deg \phi = \deg \xi = [K(x_1): K(x_2)] = \deg(f) = \max(\deg(r), \deg(s)).
  \]
\end{proof}

The lemma shows that the example \(\phi\) above has degree 2. We say \(\phi\) is a \emph{\(2\)-isogeny}.

\begin{lemma}
  \(\deg [2] = 4\).
\end{lemma}

\begin{proof}
  Assume \(\ch K \neq 2, 3\) so write \(E: y^2 = f(x) = x^3 + ax + b\). If \(P = (x, y)\) then
  \[
    x(2P)
    = \left( \frac{2x^2 + a}{2y} \right)^2 - 2x
    = \frac{(3x^2 + a)^2 - 8x f(x)}{4 f(x)} 
    = \frac{x^4 + \cdots}{4 f(x)}
  \]
  The numerator and the denominator are coprime. Indeed otherwise exists \(\theta \in \overline K\) with \(f(\theta) = f'(\theta) = 0\), so \(f\) has a multiple root, absurd. Therefore by the lemma \(\deg [2] = max(4, 3) = 4\).
\end{proof}

We will show that \(\deg [n] = n^2\) by showing that \(\deg\) is a quadratic form. This will also be useful when we prove Hasse's theorem later.

\begin{definition}
  Let \(A\) be an abelian group. \(q: A \to \Z\) is a quadratic form if
  \begin{enumerate}
  \item \(q(nx) = n^2 q(x)\) for all \(n \in \Z, x \in A\).
  \item \((x, y) \mapsto q(x + y) - q(x) - q(y)\) is \(\Z\)-bilinear.
  \end{enumerate}
\end{definition}

\begin{lemma}
  \(q: A \to \Z\) is a quadratic form if and only if it satisfies the parallelogram law
  \[
    q(x + y) + q(x - y) = 2q(x) + 2q(y)
  \]
  for all \(x, y \in A\).
\end{lemma}

\begin{proof}
  Only if is an easy exercise. If will be on example sheet 2.
\end{proof}

\begin{theorem}
  \(\deg: \Hom(E_1, E_2) \to \Z\) is a quadratic form.
\end{theorem}
Here by convention the 0 map has degree \(0\).

For the proof we assume \(\ch K \neq 2, 3\) and write \(E_2: y^2 = f(x) = x^3 + ax + b\). Let \(P, Q \in E_2\) with \(P, Q, P + Q, P - Q \neq 0\). Let \(x_1, \dots, x_4\) be the \(x\) coordinates of these four points.

\begin{lemma}
  There exist \(W_0, W_1, W_2 \in \Z[a, b][x_1, x_2]\) of degree \(\leq 2\) in \(x\) and of degree \(\leq 2\) in \(x_2\) such that
  \[
    (1: x_3 + x_4: x_3x_4) = (W_0: W_1: W_2).
  \]
\end{lemma}

\begin{proof}
  Method 1 is to calculate directly and get \(W_0 = (x_1 - x_2)^2, \dots\). See formula sheet.

  Method 2: let \(y = \lambda x + \nu\) be the line through \(P\) and \(Q\) so
  \[
    f(x) - (\lambda x + \nu)^2 = (x - x_1)(x - x_2)(x - x_3).
  \]
  By comparing coefficients we get
  \begin{align*}
    \lambda^2 &= s_1 \\
    -2 \lambda \nu &= s_2 - a \\
    \nu^2 &= s_3 + b
  \end{align*}
  where \(s_i\) is the \(i\)th elementary symmetric polynomial in \(x_1, x_2, x_3\). Eliminating \(\lambda\) and \(\mu\) gives
  \[
    \underbrace{(s_2 - a)^2 - 4s_1 (s_3 + b)}_{F(x_1, x_2, x_3)} = 0
  \]
  where \(F\) has degree \(\leq 2\) in each \(x_i\). \(x_3\) is a root of the quadratic \(W(t) = F(x_1, x_2, t)\). Repeating for line through \(P\) and \(-Q\) shows \(x_4\) is also a root of \(W(t)\). Write \(W(t) = W_0t^2 - W_1t + W_2\) and then
  \[
    (1: x_3 + x_4: x_3x_4) = (W_0: W_1: W_2).
  \]
\end{proof}

We show that if \(\phi, \psi \in \Hom(E_1, E_2)\) then
\[
  \deg (\phi + \psi) + \deg (\phi - \psi) \leq 2 \deg(\phi) + 2 \deg(\psi).
\]
We may assume \(\phi, \psi, \phi + \psi, \phi - \psi \neq 0\) as the other cases are trivial or we may use \(\deg [2] = 4\). Let the \(x\) coordinate of \(\phi(x, y), \psi(x, y), (\phi + \psi)(x, y), (\phi - \psi)(x, y)\) be \(\xi_1(x), \dots, \xi_4(x)\) respectively. Put \(\xi_i = \frac{r_i}{s_i}\) where \(r_i, s_i \in K[x]\) coprime and use the above lemma, we get
\[
  (s_3s_4: r_3s_4 + r_4s_3: r_3r_4) = ((r_1s_2 - r_2s_1)^2: \cdots ).
\]
Note that the three coordinates on LHS are coprime. We have
\begin{align*}
  &\deg (\phi + \psi) + \deg (\phi - \psi) \\
  &= \max(\deg (r_3), \deg (s_3)) + \max (\deg (r_4), \deg (s_4)) \\
  &= \max(\deg (s_3s_4), \deg (r_3s_4 + r_4s_3), \deg (r_3r_4)) \quad \text{case checking} \\
  &\leq 2 \max(\deg(r_1), \deg(s_1)) + 2 \max(\deg (r_2), \deg (s_2)) \quad \text{as terms on LHS are coprime} \\
  &= 2 \deg (\phi) + 2 \deg (\psi)
\end{align*}

Now replace \(\phi, \psi\) by \(\phi + \psi\) and \(\phi - \psi\) to get
\[
  \deg (2\phi) + \deg (2\psi) \leq 2 \deg (\phi + \psi) + 2 \deg(\phi - \psi)
\]
Since \(\deg [2] = 4\) we get
\[
  2 \deg (\phi) + 2 \deg (\psi) \leq \deg (\phi + \psi) + \deg (\phi - \psi)
\]
Together they show \(\deg\) satisfies the parallelogram law, so \(\deg\) is a quadratic form.

\begin{corollary}
  \(\deg (n\phi) = n^2 \deg (\phi)\) for all \(n \in \Z, \phi \in \Hom(E_1, E_2)\). In particular \(\deg [n] = n^2\).
\end{corollary}

\section{Invariant differential}

We want to find out when a morphism is separable so we may apply Riemann-Hurwitz. To do so we use differentials.

Let \(C\) be an algebraic curve over \(K = \overline K\). The space of differentials \(\Omega_C\) is the \(K(C)\)-vector spaces generated by \(df\) for \(f \in K(C)\) subject to the relations
\begin{enumerate}
\item \(d(f + g) = df + dg\),
\item \(d(fg) = f dg + g df\),
\item \(da = 0\) for all \(a \in K\).
\end{enumerate}

\begin{fact}
  \(\Omega_C\) is a \(1\)-dimensional \(K(C)\)-vector space.
\end{fact}

Let \(0 \neq \omega \in \Omega_C\). Let \(P \in C\) be a smooth point with uniformiser \(t \in K(C)\). It is a fact that \(dt \neq 0\) so we may write \(\omega = f dt\) for some \(f \in K(C)^*\). We define \(\ord_p(\omega) = \ord_p(f)\). This is independent of choice of \(t\).

\begin{fact}
  Suppose \(f \in K(C)^*\) and \(\ord_P(f) = n \neq 0\). If \(\ch K \ndivides n\) then \(\ord_P(df) = n - 1\).
\end{fact}

We now assume \(C\) is a smooth projective curve.

\begin{fact}
  \(\ord_p(\omega) = 0\) for all but finitely many \(P \in C\).
\end{fact}

\begin{definition}
  We define \(\div(\omega) = \sum_{P \in C} \ord_P(\omega) P \in \Div(C)\).
\end{definition}

\begin{definition}
  We define the genus of \(C\) to be
  \[
    g(C) = \dim_K \{\omega \in \Omega_C: \div(\omega) \geq 0\},
  \]
  the dimension of the space of \emph{regular differentials}.
\end{definition}

As a consequence of Riemann-Roch, we have if \(0 \neq \omega \in \Omega_C\) then \(\deg(\div(\omega)) = 2 g(C) - 2\).

\begin{lemma}
  Assume \(\ch k \neq 2\) and \(E: y^2 = (x - e_1)(x - e_2)(x - e_3)\). Then \(\omega = \frac{dx}{y}\) is a differential on \(E\) with no zeros or poles. In particular \(g(E) = 1\) and the \(K\)-vector space of regular differentials on \(E\) is \(1\)-dimensional, spanned by \(\omega\).
\end{lemma}

\begin{proof}
  Let \(T_i = (e_i, 0)\) and we know \(E[2] = \{0, T_1, T_2, T_3\}\). We have
  \[
    \div (y) = (T_1) + (T_2) + (T_3) - 3(0_E)
  \]
  \(T_i\) appears with multiplicity \(1\) in \(\div y\) since we know \(\deg \div y = 0\). If \(P \in E \setminus \{0\}\) then
  \[
    \div (x - x_P) = (P) + (-P) - 2(0_E).
  \]
  If \(P \in E \setminus E[2]\) then \(\ord_P(x - x_P) = 1\) so \(ord_P(dx) = 0\). If \(P = T_i\) then \(\ord_P(x - x_P) = 2\) so \(\ord_P(dx) = 1\). Finally if \(P = 0_E\) then \(\ord_P(x) = -2\) so \(\ord_P(dx) = -3\). Therefore
  \[
    \div(dx) = (T_1) + (T_2) + (T_3) - 3(0_E).
  \]
  It follows that \(\div (\frac{dx}{y}) = 0\).
\end{proof}

\begin{definition}
  If \(\phi: C_1 \to C_2\) is a nonconstant morphism then we have \emph{pullback of differentials} defined by
  \begin{align*}
    \phi^*: \Omega_{C_2} &\to \Omega_{C_1} \\
    f dg &\mapsto (\phi^* f) d(\phi^*g)
  \end{align*}
\end{definition}

\begin{lemma}
  Let \(P \in E\) and \(\tau_P: E \to E, X \mapsto P + X\). If \(\omega = \frac{dx}{y}\) then \(\tau_P^* \omega = \omega\). \(\omega\) is called the \emph{invariant differential}\index{invariant differential}.
\end{lemma}

\begin{proof}
  \(\tau_p^*\omega\) is again a regular differential on \(E\) so \(\tau_P^* \omega = \lambda_P \omega\) for some \(\lambda_P \in K^*\). The map \(E \to \P^1, P \mapsto \lambda_P\) (after a calculation we know the map is rational) is a morphism of smooth projective curve but \emph{not} surjective, as it misses \(0, \infty\). Therefore it is constant. Thus exists \(\lambda \in K^*\) such that \(\tau_P^* \omega = \lambda \omega\) for all \(P \in E\). Taking \(P = 0_E\) shows \(\lambda = 1\).
\end{proof}

\begin{remark}
  If \(K = \C\) then remember we have an isomorphism \(\C/\Lambda \cong E(\C), z \mapsto (\wp(z), \wp'(z))\) so
  \[
    \frac{dx}{y} = \frac{\wp'(z) dz}{\wp'(z)} = dz,
  \]
  which is manifestly invariant under \(z \mapsto z + \text{ constant}\).
\end{remark}

\begin{lemma}
  Let \(\phi, \psi \in \Hom(E_1, E_2)\) and \(\omega\) the invariant differential on \(E_2\). Then \((\phi + \psi)^* \omega = \phi^*\omega + \psi^*\omega\).
\end{lemma}

\begin{proof}
  Write \(E = E_2\). We have three maps
  \begin{align*}
    E \times E &\to E \\
    \mu: (P, Q) &\mapsto P + Q \\
    \pi_1: (P, Q) &\mapsto P \\
    \pi_2: (P, Q) &\mapsto Q
  \end{align*}
  As \(E \times E\) is \(2\)-dimensional, it is a fact that \(\Omega_{E \times E}\) is a \(2\)-dimensional \(K(E \times E)\)-vector space with basis \(\pi_1^* \omega, \pi_2^* \omega\). Then \(\mu^* \omega = f \pi_1^* \omega + g \pi_2^* \omega\) for some \(f, g \in K(E \times E)\). For \(Q \in E\) let \(\iota_Q: E \to E \times E, P \mapsto (P, Q)\). Applying \(\iota_Q^*\) gives
  \[
    (\mu \iota_Q)^* \omega = (\iota_Q^* f) (\pi_1 \iota_Q)^* \omega + (\iota_Q^* g) (\pi_2 \iota_Q)^* \omega,
  \]
  i.e.
  \[
    \tau_Q^* \omega = (\iota_Q^* f) \omega + 0
  \]
  so \(\iota_Q^*f = 1\) for all \(Q \in E\), so \(f(P, Q) = 1\) for all \(P, Q \in E\). Similarly \(g(P, Q) = 1\). Thus \(\mu^*\omega = \pi_1^* \omega + \pi_2^* \omega\). Now pullback by \(E \to E \times E, P \mapsto (\phi(P), \psi(P))\) to get
  \[
    (\phi + \psi)^*\omega = \phi^*\omega + \psi^*\omega.
  \]
\end{proof}









\printindex
\end{document}

% Silverman, The arithmetic of elliptic curves, Springer 1986
% Cassels, Lectures on ellptic curves, CUP 1991

% Introductory reading
% Silverman & Tate, Rational points on elliptic curves, Springer 1992
% Milne, Elliptic curves, Booksurge 2006